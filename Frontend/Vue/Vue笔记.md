# Vue笔记

## Vue单文件组件

Vue单文件组件本质上是一个ES6模块，所以可以通过 `export default` 导出。

Vue中所有的组件、js文件都是模块（Module）。

如果一个Vue模块（Module）有HTML模板（可能同时还有CSS）则使用.Vue单文件组件，如果只有JS逻辑则做成普通的JS Module。

### Vue CLI

查看Vue CLI的版本：

`vue --version`

卸载旧版vue-cli（3.x以下）：

`npm uninstall vue-cli -g`

全局安装（3.x以上）：

`npm install -g @vue/cli`

创建一个新项目：

`vue create hello-world`

启动Vue GUI：

`vue ui`

使用Vue CLI 3.x以下版本初始化项目之后需要另行安装的包：

less开发依赖

`npm i --save-dev less less-loader`

其他常用依赖：

axios

`npm install --save axios`


### 组件内部的数据定义方式共3种：

1. 预定义的数据使用 `data` 定义
2. 动态生成的数据使用 `computed` 定义
3. 从父组件传入的数据使用 `props` 定义

3种数据都可以用于文本插值（使用 `{{}}` 或 `v-text` 或 `v-html` ），也都可以在组件内部的js逻辑中调用（使用 `this.name` ）。

### 父子组件通信机制

Vue子组件相当于一个函数，props就相当于是可传入函数的参数。

父组件通过props向子组件传递数据，需要在父组件中用 `v-bind` 传入props，在子组件中声明接收的props。

子组件通过 `this.$emit` 触发自定义事件，并向父组件回传数据，在父组件中使用 `v-on` 监听子组件中触发的自定义事件并调用父组件中定义的方法，调用的方法可接收从子组件回传的数据。

### 通用组件间通信机制---事件总线

父子组件之间传递数据相对简单，但如果是兄弟组件或无特别关系（同一个父组件内部）的组件呢？

组件之间的通信主要是包括两个方面：

#### 1、互相监听事件

**1.1 父子组件**

1.1.1 父组件监听子组件内的事件

子组件内部的事件如果是 `$emit` 触发的自定义事件，则直接在父组件的模板内用 `v-on`
监听即可；子组件内部的事件如果是原生事件，则在子组件内部先监听原生事件，在回调函数中用 `$emit` 触发一个自定义事件（即先将原生事件封装为自定义事件），然后在父组件的模板内用 `v-on` 监听封装的自定义事件即可。

1.1.2 子组件监听父组件内的事件

使用全局事件总线（Global Event Bus）。

在父子组件中都引入（ `import` ）事件总线，通过事件总线来转发事件和数据。

在父组件中用事件总线触发（ `$emit` ）一个自定义事件，同时传递数据。在子组件中用事件总线监听（ `$on` ）父组件触发的自定义事件，执行回调函数并且接收来自父组件的数据。

**1.2 兄弟组件或无特别关系的组件**

只能使用事件总线来互相触发和监听自定义事件。

#### 2、互相传递数据

**2.1 父子组件**

2.1.1 父组件往子组件传递数据

直接使用props传入即可。

使用事件总线传递亦可，但一般不必这么做。

2.1.2 子组件往父组件传递数据

用 `$emit` 触发一个自定义事件同时可传递数据，在父组件模板内用 `v-on` 监听子组件触发的自定义事件，执行的方法可接收该事件传递的数据。

在组件内部 `$emit` 有两种用法：

`this.$emit`：事件装载的数据只能传递给父组件，无法传给其他组件。

`EventBus.$emit`：事件装载的数据可传递给很多组件（当然也包括父组件）。

**2.2 兄弟组件或无特别关系的组件**

若是同级兄弟组件，可通过父组件中转，但这样做比较麻烦，特别是层级相距大的组件之间如果通过共同的父组件来传递数据的话太麻烦了，效率很低，最佳方案还是事件总线。
